<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="full-screen" content="yes"/>
    <meta name="screen-orientation" content="portrait"/>
    <meta name="viewport" content="user-scalable=no"/>  
    <link rel="stylesheet" href="css/bootstrap/css/bootstrap.min.css">
</head>

<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://www.facebook.com/assets.php/en_US/fbinstant.latest.js"></script>
<script type="text/javascript">
  const randomImages = [
        'img/fool.jpg',
        'img/hand.jpg',
        'img/lol.png',
        'img/respect.jpg',
        'img/heart.jpg',
        'img/fuck.jpg'
      ];
  window.onload = function(){
    $('#result').hide();
    this.checkFont();
    FBInstant.initializeAsync().then(function(){
      for (let i in randomImages) {
          // When preloading assets, make sure to report the progress
          FBInstant.setLoadingProgress(i / randomImages.length * 100);
        }
    FBInstant.startGameAsync().then(onStart);
  });
  };
 
  function onStart(){
    
    $('#photo').attr('src', FBInstant.player.getPhoto());
    $('#player-name').html(FBInstant.player.getName());
    $('#player-id').html(FBInstant.player.getID());
    $('#context-type').html(FBInstant.context.getType());
  }

  function show(){
    $('#result').height(30).width(30);
    var screenWidth = $('#result').parent().width()/0.5;
    var screenHeight = screen.height/0.5;
    
    var image;
    if (FBInstant.player.getName() === "Tweter") {
      image = 'img/heart.png';
    } else {
      
      image = randomImages[Math.floor(Math.random()*randomImages.length)];
      $('#result').attr('src',image);
    }
    $('#result').show();
    $("#result").animate({
      left: '250px',
      height: '+='+screenHeight+'px',
      width: '+='+screenWidth/4+'px',
      opacity: '0.4'

    },"slow");
    $("#result").animate({
      width: '+='+screenWidth+2+'px',
      opacity: '0.7'
    },"slow");
    $("#result").animate({
      width: '+='+screenWidth+'px',
      opacity: '0.9'
    },"slow");
  }

  function checkFont(){
    const el = document.createElement('canvas');
    const ctx = el.getContext("2d");
    const kaWidth = ctx.measureText('á€€').width;
    const patSintWidth = ctx.measureText('á€€á€¹á€€').width;

    if (kaWidth === patSintWidth) {
      $('#main_label').html('á€á€„á€·á€ºá€€á€­á€¯ á€œá€°á€á€½á€± á€•á€¼á€¯á€™á€°á€á€»á€„á€ºá€á€²á€· á€•á€¯á€¶á€…á€¶á€€ á€˜á€šá€ºá€œá€­á€¯ á€•á€¯á€¶á€…á€¶á€œá€²á‹  ğŸ¤¡');
    }else{
      $('#main_label').html('á€á€„á€¹á€·á€€á€­á€¯ á€œá€°á€±á€á€¼ á€»á€•á€³á€™á€°á€á€ºá€„á€¹á€á€²á€· á€•á€¶á€¯á€…á€¶á€€ á€˜á€šá€¹á€œá€­á€¯ á€•á€¶á€¯á€…á€¶á€œá€²á‹ ğŸ¤¡');
    }
   
  }

</script>
<header class="navbar navbar-expand-lg navbar-dark bg-primary"> 
  <div class="">
      <h1 class="text-white">Instant Games Test</h1>
  </div>
  </header>
  <section>
      <div class="container">
        <img id="result" class="rounded" alt="Result">
      </div>
      <hr>
     <div class="d-flex justify-content-center">
        <img id="photo" height="100" width="100" class="rounded-circle mx-auto d-block" alt="User Photo">
     </div>
    
      <table class="table table-dark">
        <tr>
          <th scope="col">Player Name</th>
          <td id="player-name"></td>
          
        </tr>
        <tr>
            <th scope="col">Player ID</th>
            <td id="player-id"></td>
        </tr>
        <tr>
            <th scope="col">Context Type</th>
            <td id="context-type"></td>
        </tr>
      </table>
      <h3 id="main_label" class="alert alert-warning text-center"></h3>
      <button type="button" class="btn btn-primary btn-lg btn-block" onclick="show()">Click Me</button>
      
	</section>
 
</body>

</html>